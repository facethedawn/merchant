{"version":3,"file":"common.js","mappings":";;;;;;;;;;;;;;;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAIA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AArCA;AAAA;AAAA;AAuCA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AExEA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACJA;AACA;AAAA;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;;;;ACzBA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAGA;AAEA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;;;;;;;;;;;;;;;;ACtCA;AACA;AAAA;AAEA;AAAA;AAAA;AAEA;AACA;AACA;AAEA;AAEA;AAAA;AAGA;AACA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;ACnBA;AAAA;AAEA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;AChBA;AACA;AAEA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AAAA;AAEA;AAAA;AAMA;AAAA;AAAA;AAMA;AAAA;AAAA;AAGA;AAAA;AAAA;AAEA;AAGA;;;;;;;;;;;;;;;;;;ACpCA;AACA;AAEA;AAAA;AAAA;AAEA;AACA;AAAA;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;ACdA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACFA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;;;;;;;;;;;;;;;;;;ACbA;AAEA;AAEA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAGA;;;;;;;;;;;;;;ACfA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAgBA;AAAA;AAAA;AAAA;AAdA;AAAA;AAAA;AAAA;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;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAIA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AAAA;AAGA;AAAA;AAIA;AAEA;;;;;;;;;;;;;;;;;;;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAIA;AAEA;;;;;;;;;;;;;;;;;;;;;ACvCA;AACA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAGA;AAEA;;;;;;;;;;;;;;;;;;ACdA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;;;;;;;;;;;;;;ACfA;;;;;;;;;;;;;;ACAA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACjBA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAeA;AAAA;AAfA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACvOA;AACA;AACA;;;;;;;;;;;;;;;;;ACFA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACLA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;ACVA","sources":["webpack://taro-mobile-react/._src_account_components_accountForm_components_accountItem_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_codeItem_components_codeWrap_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_codeItem_components_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_codeItem_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_index.ts","webpack://taro-mobile-react/._src_account_components_accountForm_components_mobileItem_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_passwordItem_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_readOnlyItem_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_components_submitBtn_index.tsx","webpack://taro-mobile-react/._src_account_components_accountForm_index.tsx","webpack://taro-mobile-react/._src_account_components_agreementEntry_index.tsx","webpack://taro-mobile-react/._src_account_components_index.ts","webpack://taro-mobile-react/._src_account_components_linkReg_index.tsx","webpack://taro-mobile-react/._src_account_components_topLogo_index.tsx","webpack://taro-mobile-react/._src_account_constans.ts","webpack://taro-mobile-react/._src_account_hooks_index.ts","webpack://taro-mobile-react/._src_account_hooks_useAccountForm_index.ts","webpack://taro-mobile-react/._src_account_hooks_useAgreement_index.ts","webpack://taro-mobile-react/._src_account_hooks_useAuth_index.ts","webpack://taro-mobile-react/._src_account_hooks_useBindPhone.ts","webpack://taro-mobile-react/._src_components_baseWrapCommon.tsx","webpack://taro-mobile-react/._src_components_custom-common_index.tsx","webpack://taro-mobile-react/._src_components_dynamicComponent.tsx","webpack://taro-mobile-react/._src_components_header.tsx","webpack://taro-mobile-react/._src_components_index.tsx","webpack://taro-mobile-react/._src_custom-tab-web_index.tsx","webpack://taro-mobile-react/._src_routerMap_append.ts","webpack://taro-mobile-react/._src_routerMap_basic.ts","webpack://taro-mobile-react/._src_utils_auth.ts","webpack://taro-mobile-react/._src_utils_index.ts","webpack://taro-mobile-react/._src_utils_router.ts","webpack://taro-mobile-react/._src_utils_safeArea.ts","webpack://taro-mobile-react/._src_utils_validator.ts","webpack://taro-mobile-react/ignored|_Users_devil_Desktop_taro_taro-mobile-react_node_modules_object-inspect|._util.inspect"],"sourcesContent":["import {Form, Input} from 'antd-mobile'\n\nexport const AccountItem = ({txt = '账号'}) => {\n  return (\n    <Form.Item\n      name='account'\n      rules={[\n        {\n          required: true,\n          message: `${txt}不能为空`\n        },\n      ]}\n    >\n      <Input\n        clearable\n        placeholder={`请输入${txt}`}\n      />\n    </Form.Item>\n  )\n}\n","import {useEffect, useRef, useState} from \"react\";\nimport {View} from '@tarojs/components';\nimport {mobileRex} from \"@/utils\";\nimport {sendPhone, checkUserPhone} from 'qj-b2c-api';\nimport {taroMessage} from \"@brushes/utils\";\n\nconst seconds = 60;\n\nexport const CodeWrap = ({form, type}) => {\n  const [timeFlag, setTimeFlag] = useState(false);\n  const [time, setTime] = useState<number>(seconds);\n  const timeRef = useRef<any>();\n  const [lock, setLock] = useState(false);\n\n  const getMobile = async () => {\n    if (lock) return;\n    const mobile = form.getFieldValue('mobile');\n    if (!mobile) {\n      taroMessage('请填写手机号', 'error');\n      return;\n    }\n\n    const pass = type === 'mobileLogin'? true:mobileRex.test(mobile);\n\n    if (!pass) {\n      taroMessage('请填写正确的手机号', 'error');\n      return;\n    } else {\n      setLock(true);\n      try {\n        const phone = {\n          userPhone: mobile\n        }\n        if(type === 'reg') {\n          const checkResult = await checkUserPhone(phone);\n          if(!checkResult.success) {\n            taroMessage(checkResult.msg, 'error');\n            return\n          }\n        }\n\n        const result = await sendPhone(phone)\n        console.log(26, result);\n        setTimeFlag(true)\n        setTime(seconds);\n      } catch (err) {\n        console.log(err);\n      } finally {\n        setLock(false);\n      }\n    }\n  }\n\n  useEffect(() => {\n    if (time && time !== 0)\n      timeRef.current = setTimeout(() => {\n        setTime(time - 1);\n      }, 1000)\n    if (time === 0) setTimeFlag(false);\n    return () => {\n      clearTimeout(timeRef.current);\n    }\n  }, [time]);\n\n\n  return (\n    <View>\n      {\n        timeFlag ? <View>倒计时 {time} 秒</View> : <View onClick={getMobile}>获取验证码</View>\n      }\n    </View>\n  )\n}\n","export * from './codeWrap';\n","import {Form, Input} from 'antd-mobile'\nimport {CodeWrap} from \"./components\";\n\nexport const CodeItem = ({txt = '验证码', form, type}) => {\n  return (\n    <Form.Item\n      name='code'\n      extra={\n        <CodeWrap form={form} type={type} />\n      }\n      rules={[\n        {\n          required: true,\n          message: `${txt}不能为空`\n        }\n      ]}\n    >\n      <Input\n        maxLength={6}\n        clearable\n        placeholder={`请输入${txt}`}\n      />\n    </Form.Item>\n  )\n}\n","export * from './mobileItem';\nexport * from './codeItem';\nexport * from './passwordItem';\nexport * from './accountItem';\nexport * from './readOnlyItem';\nexport * from './submitBtn';\n","import {Form, Input} from 'antd-mobile'\nimport {mobileRex} from \"@/utils\";\n\nexport const MobileItem = ({txt = '手机号'}) => {\n  return (\n    <Form.Item\n      name='mobile'\n      rules={[\n        {\n          required: true,\n          message: `${txt}不能为空`\n        },\n        {\n          pattern: mobileRex,\n          message: `请输入正确${txt}`\n        }\n      ]}\n    >\n      <Input\n        maxLength={11}\n        clearable\n        placeholder={`请输入${txt}`}\n      />\n    </Form.Item>\n  )\n}\n\n","import {useState} from \"react\";\nimport {View} from '@tarojs/components';\nimport {Form, Input} from 'antd-mobile'\nimport {IconMobile} from '@brushes/simulate-component';\n\nexport const PasswordItem = ({txt = '密码'}) => {\n  const [pwdType, setPwdType] = useState(true)\n\n  const checkPwd = (_: any, value: any) => {\n    if (value.length > 5 && value.length < 13) {\n      return Promise.resolve()\n    }\n    return Promise.reject(new Error(`请输入6-12位${txt}`));\n  }\n\n  return (\n    <Form.Item\n      name='password'\n      rules={[\n        {\n          required: true,\n          message: `${txt}不能为空`\n        },\n        {\n          validator: checkPwd\n        }\n      ]}\n      extra={\n        <View onClick={() => setPwdType(!pwdType)}>\n          {\n            pwdType ? <IconMobile value='yincang' /> : <IconMobile value='liulan' />\n          }\n        </View>\n      }\n    >\n      <Input placeholder={`请输入${txt}`} clearable type={pwdType ? 'password' : 'text'} />\n    </Form.Item>\n  )\n}\n","import {Form, Input} from 'antd-mobile'\nimport {useEffect} from \"react\";\n\nexport const ReadOnlyItem = ({originPhone, form}: any) => {\n\n  useEffect(() => {\n    form.setFieldValue('mobile', originPhone);\n  }, [originPhone])\n\n  return (\n    <Form.Item\n      name='mobile'\n    >\n      <Input\n        placeholder={originPhone}\n        readOnly\n      />\n    </Form.Item>\n  )\n}\n","import { Button } from 'antd-mobile'\n\nexport const SubmitBtn = ({btnText}) => {\n\n  return (\n    <Button\n      block\n      shape='rounded'\n      size='large'\n      type='submit'\n      style={{\n        '--background-color': '#000000',\n        '--text-color': '#FFFFFF'\n      }}\n    >{btnText}</Button>\n  )\n}\n","import {View} from '@tarojs/components';\nimport {Form} from 'antd-mobile';\n\nimport {MobileItem, CodeItem, PasswordItem, SubmitBtn, AccountItem, ReadOnlyItem} from \"./components\";\nimport {useAccountForm} from \"../../hooks\";\n\nexport const AccountForm = ({type, btnText, txt, originPhone}: {type: string; btnText: string; txt?: string; originPhone?: string}) => {\n  const {form, onFinish} = useAccountForm(type)\n\n  return (\n    <View>\n      <Form\n        form={form}\n        footer={\n          <SubmitBtn btnText={btnText} />\n        }\n        onFinish={onFinish}\n      >\n        {\n          ['accountLogin'].includes(type) ? <AccountItem /> : null\n        }\n        {\n          ['confirmPhone'].includes(type) ? <ReadOnlyItem originPhone={originPhone} form={form} /> : null\n        }\n        {\n          ['forgetPwd', 'reg', 'mobileLogin', 'bindPhone'].includes(type) ? <MobileItem /> : null\n        }\n        {\n          ['reg', 'mobileLogin','forgetPwd', 'confirmPhone', 'bindPhone'].includes(type) ? <CodeItem form={form} type={type} /> : null\n        }\n        {\n          ['reg', 'accountLogin','forgetPwd'].includes(type) ? <PasswordItem txt={txt}  /> : null\n        }\n      </Form>\n    </View>\n  )\n}\n","import {View} from '@tarojs/components';\nimport {useAgreement} from \"../../hooks\";\n\nimport './index.scss'\n\nexport const AgreementEntry = () => {\n  const {goDetail} = useAgreement()\n\n\n  return (\n    <View className='agreement'>\n      注册和登录即代表同意 《<View className='link' onClick={goDetail.bind(null, 'xieyi')}>用户协议</View>》 和 《<View className='link' onClick={goDetail.bind(null, 'yinsi')}>隐私政策</View>》\n    </View>\n  )\n}\n","export * from './topLogo';\nexport * from './accountForm';\nexport * from './agreementEntry';\nexport * from './linkReg';\n","import {View} from '@tarojs/components';\nimport Taro from '@tarojs/taro';\n\nexport const LinkReg = () => {\n  const goReg = () => {\n    Taro.navigateTo({\n      url: 'account/register/index'\n    })\n  }\n\n  return (\n    <View onClick={goReg} style={{paddingRight: '10px'}}>注册</View>\n  )\n}\n","import {View} from '@tarojs/components';\n\nimport './index.scss';\n\nimport logo from './logo.png';\n\nexport const TopLogo = () => {\n  return (\n    <View className='topLogo'>\n      <View className='logo' style={{\n        backgroundImage: `url(${logo})`\n      }}\n      ></View>\n    </View>\n  )\n}\n","export const accountConst = {\n  oldUserPhone: ''\n}\n","export * from './useAccountForm';\nexport * from './useCode';\nexport * from './useAgreement';\nexport * from './useAuth';\nexport * from './useBindPhone';\n","import {useState} from \"react\";\nimport {Form} from 'antd-mobile';\nimport Taro from '@tarojs/taro';\nimport {saveUmuserPhone, saveUmuserPhoneVCode, login, updateUmuserPw, checkVerificationMa, updateUserPhoneByUserPhone} from 'qj-b2c-api';\nimport {errorCallback} from '@brushes/request';\nimport {setStorage} from '@brushes/utils';\nimport {accountConst} from \"@/account/constans\";\nimport {routerMap} from \"qj-mobile-store\";\n\nexport const stackLength = () => {\n  const arr = Taro.getCurrentPages();\n  const obj = {\n    pageIndex: 0\n  }\n  for(let i=0; i<arr.length; i++) {\n    if(arr[i]['$taroPath'].indexOf('account/')>=0) {\n      if(i===0) {\n        obj.pageIndex = 0\n      }else {\n        obj.pageIndex = arr.length-i\n      }\n      break\n    }\n  }\n  return obj.pageIndex;\n}\n\nexport const useAccountForm = (type?: string) => {\n  const [form] = Form.useForm();\n  const [submitLock, setSubmitLock] = useState(false);\n\n  const onFinish = async (formVal) => {\n    if (submitLock) return;\n    switch (type) {\n      case 'reg':\n        await regSubmit(formVal);\n        break;\n      case 'mobileLogin':\n        await mobileLoginSubmit(formVal);\n        break;\n      case 'accountLogin':\n        await accountLoginSubmit(formVal);\n        break;\n      case 'forgetPwd':\n        await forgetPwdSubmit(formVal);\n        break;\n      case 'confirmPhone':\n        await confirmPhoneSubmit(formVal);\n        break;\n      case 'bindPhone':\n        await bindPhoneSubmit(formVal);\n        break;\n    }\n  }\n\n  const regSubmit = async (formVal) => {\n    const params = {\n      userPhone: formVal.mobile,\n      code: formVal.code,\n      userPwsswd: formVal.password,\n      userinfoType: 1,\n      userName: formVal.mobile\n    }\n    try {\n      setSubmitLock(true)\n      await saveUmuserPhone(params);\n      Taro.navigateBack({\n        delta: 1\n      })\n    } catch (err) {\n      console.log(27, err);\n    } finally {\n      setSubmitLock(false)\n    }\n  }\n\n  const mobileLoginSubmit = async(formVal) => {\n    const params = {\n      userPhone: formVal.mobile,\n      code: formVal.code,\n      userinfoType: 1,\n    }\n    try {\n      setSubmitLock(true)\n      const result = await saveUmuserPhoneVCode(params);\n      setStorage('saas-token', result.dataObj.ticketTokenid);\n      Taro.navigateBack({\n        delta: stackLength(),\n        success: (res) => {\n          console.log('调用前', res);\n          errorCallback();\n        }\n      })\n    } catch (err) {\n      console.log(27, err);\n    } finally {\n      setSubmitLock(false)\n    }\n  }\n\n  const accountLoginSubmit = async (formVal) => {\n    const params = {\n      loginName: formVal.account,\n      passwd: formVal.password,\n      code: 1234\n    }\n    try {\n      setSubmitLock(true)\n      const result = await login(params);\n      setStorage('saas-token', result.dataObj.ticketTokenid);\n      Taro.navigateBack({\n        delta: stackLength(),\n        success: function () {\n          errorCallback()\n        }\n      })\n    } catch (err) {\n      console.log(27, err);\n    } finally {\n      setSubmitLock(false)\n    }\n  }\n\n  const forgetPwdSubmit = async (formVal) => {\n    console.log(70, formVal)\n    const params = {\n      userPhone: formVal.mobile,\n      code: formVal.code,\n      userPwsswd: formVal.password,\n    }\n    try {\n      setSubmitLock(true)\n      await updateUmuserPw(params);\n      Taro.navigateBack({\n        delta: 1,\n      })\n    } catch (err) {\n      console.log(27, err);\n    } finally {\n      setSubmitLock(false)\n    }\n  }\n\n  const confirmPhoneSubmit = async (formVal) => {\n    const params = {\n      userPhone: formVal.mobile,\n      code: formVal.code,\n    }\n\n    try {\n      const result = await checkVerificationMa(params);\n      if(result.success) {\n        console.log(148, result)\n        Taro.navigateTo({\n          url: `${routerMap.bindPhone}?oldUserPhone=${formVal.mobile}`\n        })\n      }\n    }catch (err) {\n      console.log(err);\n    }\n  }\n\n  const bindPhoneSubmit = async (formVal) => {\n    const params = {\n      newUserPhone: formVal.mobile,\n      code: formVal.code,\n      oldUserPhone: accountConst.oldUserPhone\n    }\n    try {\n      const result = await updateUserPhoneByUserPhone(params);\n      if(result.success) {\n        Taro.showToast({\n          title: '绑定成功',\n          icon: 'success',\n          duration: 2000,\n          success:() => {\n            setTimeout(() => {\n              Taro.navigateBack({\n                delta: 3\n              })\n            }, 2000);\n          }\n        })\n      }\n    }catch (err) {\n      console.log(err);\n    }\n  }\n\n\n\n\n  const goRegister = () => {\n    Taro.navigateTo({\n      url: routerMap.register\n    })\n  }\n\n  const goAccountLogin = () => {\n    Taro.navigateTo({\n      url: routerMap.accountLogin\n    })\n  }\n\n  const goMobileLogin = () => {\n    Taro.navigateTo({\n      url: routerMap.mobileLogin\n    })\n  }\n\n  const goForgetPwd = () => {\n    Taro.navigateTo({\n      url: routerMap.forgetPwd\n    })\n  }\n\n\n  return {\n    form,\n    onFinish,\n    goRegister,\n    goAccountLogin,\n    goMobileLogin,\n    goForgetPwd\n  }\n}\n","import {queryProappConfigByChannel} from 'qj-b2c-api';\nimport {useEffect, useRef, useState} from \"react\";\nimport Taro from '@tarojs/taro';\nimport {get} from 'lodash-es';\n\nexport const useAgreement = (type?:string) => {\n  const [agreementData, setAgreementData] = useState('');\n  const proappCode = useRef('');\n\n  useEffect(() => {\n    (async () => {\n      setProappCode()\n      const result = await queryProappConfigByChannel();\n      const resultArr = get(result, 'list');\n      for(let i =0; i< resultArr.length; i++) {\n        if(resultArr[i].proappCode === proappCode.current && resultArr[i].proappConfigType === type) {\n          setAgreementData(resultArr[i].proappConfigText2)\n          break;\n        }\n      }\n    })()\n  }, [])\n\n  const setProappCode = () => {\n    const platform = process.env.TARO_ENV;\n    switch (platform) {\n      case 'h5':\n        proappCode.current = '003';\n        break;\n      case 'weapp':\n        proappCode.current = '025';\n        break;\n    }\n  }\n\n  const goDetail = (agreeType: string) => {\n    Taro.navigateTo({\n      url: `/account/agreement/index?type=${agreeType}`\n    })\n  }\n\n\n  return {\n    agreementData,\n    goDetail\n  }\n}\n","import {useEffect, useState} from \"react\";\nimport Taro from \"@tarojs/taro\";\nimport {queryProappEnvPage, saveUmuserPhoneNoCodeByWX, warrantyLogin} from 'qj-b2c-api';\nimport { get } from 'lodash-es'\nimport {errorCallback} from '@brushes/request';\nimport {stackLength} from '@/account/hooks';\n\nexport const useAuth = () => {\n  const [bg, setBg] = useState('');\n  const [logo, setLogo] = useState('');\n  const [agree, setAgree] = useState(true);\n\n  useEffect(() => {\n    getInfo()\n  }, [])\n\n  const getInfo = async () => {\n    try {\n      const res = await queryProappEnvPage();\n      const result = res.list[0];\n      setBg(`https://www.${result.proappEnvDomain}${result.proappEnvIndexc}`);\n      setLogo(`https://www.${result.proappEnvDomain}${result.proappEnvLogo}`);\n    }catch (err) {\n      console.log(err)\n    }\n  }\n\n  const agreeFunc = (e) => {\n    if(e.detail.value.length) {\n      setAgree(true);\n    }else {\n      setAgree(false);\n    }\n  }\n\n  const getPhone = async (e) => {\n    Taro.login({\n      success: async (res) => {\n        const warrantyResult = await warrantyLogin({\n          'js_code': res.code\n        })\n\n        const { register, userInfo, userOpenid } = get(warrantyResult, 'dataObj');\n\n        if(register === 'true') {\n          const result = await registerImpl(e, userOpenid)\n          setAuthImpl(result.dataObj.ticketTokenid)\n          return\n        }\n\n        const user = JSON.parse(userInfo);\n        setAuthImpl(user.ticketTokenid);\n      }\n    })\n  }\n\n  const registerImpl = (e, userOpenid) => saveUmuserPhoneNoCodeByWX({\n    code: e.detail.code,\n    userOpenid\n  })\n\n  const setAuthImpl = (token) => {\n    Taro.setStorageSync('saas-token', token);\n    callback()\n  }\n\n  const callback = () => {\n    Taro.navigateBack({\n      delta: stackLength(),\n      success: function () {\n        errorCallback()\n      }\n    })\n  }\n\n  return {\n    bg,\n    logo,\n    agreeFunc,\n    setAgree,\n    agree,\n    getPhone\n  }\n}\n","import {useEffect, useState} from \"react\";\nimport {INDEX_MEM} from 'qj-b2c-api';\nimport {get} from 'lodash-es';\n\nexport const useBindPhone = () => {\n  const [originPhone, setOriginPhone] = useState('');\n  useEffect(() => {\n    getOriginPhone()\n  }, [])\n\n  const getOriginPhone = async () => {\n    const result = await INDEX_MEM();\n    const phone = get(result, 'userInfo.userPhone');\n    setOriginPhone(phone);\n  }\n\n  return {\n    originPhone\n  }\n}\n","import React, {Fragment, useEffect, useMemo, useState} from \"react\";\nimport Taro, {useRouter} from \"@tarojs/taro\";\nimport {ScrollView} from \"@tarojs/components\";\nimport CommonJsx from '@/components/index';\nimport TabBarWeb from '@/custom-tab-web/index';\nimport { ApplicationContext, useApplicationContext } from 'qj-mobile-store';\n\ntype BaseWrapCommonProps = {\n  base?: boolean\n};\n\nconst BaseWrapCommonInner = (props: BaseWrapCommonProps) => {\n  const {path, params} = useRouter();\n  const [{scrollTop = 0}] = useApplicationContext();\n  const [title, setTitle] = useState('');\n  const {safeArea, tabBarH, menuOpcode, windowH} = useMemo(() => {\n    const windowH = Taro.getSystemInfoSync().windowHeight;\n    const menuOpcode = Taro.getStorageSync('menuOpcode');\n    const safeArea = Taro.getStorageSync('safeArea');\n    const tabBarH = Taro.getStorageSync('tabBarHeight');\n    return {\n      windowH,\n      safeArea,\n      tabBarH,\n      menuOpcode\n    }\n  }, []);\n\n  useEffect(() => {\n    const routerMap = Taro.getStorageSync('routerMap');\n    const {text = '首页'} = routerMap[menuOpcode] || {};\n    Taro.setNavigationBarTitle({\n      title: text\n    });\n    setTitle(text);\n  }, [])\n\n  return (\n    <Fragment>\n      <ScrollView\n        scrollY\n        enhanced\n        scrollTop={scrollTop}\n        scrollWithAnimation\n        scrollAnimationDuration='800'\n        show-scrollbar={false}\n        style={{\n          height: `calc(${windowH}px - ${safeArea}px - ${props.base ? tabBarH : 0}px)`\n        }}\n      >\n        <CommonJsx navigationBarTitle={title} route={path} {...params} />\n      </ScrollView>\n      <TabBarWeb base={props.base || false}/>\n    </Fragment>\n  )\n}\n\nexport const BaseWrapCommon = (props: BaseWrapCommonProps) => {\n  return (\n    <ApplicationContext>\n      <BaseWrapCommonInner {...props}/>\n    </ApplicationContext>\n  )\n}\n","import {useState} from 'react';\nimport { CoverView, CoverImage } from '@tarojs/components';\nimport {useMenu} from '@brushes/taro-hooks';\nimport {navigatorHandler} from '@brushes/utils';\nimport {useRouter} from '@tarojs/taro';\n\nconst TabBar = () => {\n  const { path } = useRouter();\n  const [color,] = useState('#b8b8b8');\n  const [selectedColor,] = useState('#000000');\n  const menuList = useMenu();\n\n  const switchTab = (menuOpcode) => {\n    navigatorHandler(menuOpcode)\n  }\n\n  return (\n    <CoverView className='tab-bar'>\n      <CoverView className='tab-bar-border'></CoverView>\n      {menuList.map((item, index) => {\n        return (\n          <CoverView key={index} className='tab-bar-item' onClick={() => switchTab(item.menuOpcode)}>\n            <CoverImage className='tab-bar-item-img' src={path.includes(item.pagePath) ? item.selectedIconPath : item.iconPath} />\n            <CoverView className='tab-bar-item-view' style={{ color: path.includes(item.pagePath) ? selectedColor : color }}>{item.text}</CoverView>\n          </CoverView>\n        )\n      })}\n    </CoverView>\n  )\n}\n\n\nexport default TabBar;\n","import { get, noop } from 'lodash-es';\nimport * as materials from 's-material-react';\nimport {Fragment, memo} from 'react';\nimport {useDataSource, useDataSourceWithContext} from '@brushes/taro-hooks';\n\nconst ComponentWithContext = memo(\n  ({ component_devil_type, withPageStore, ...rest } : {component_devil_type: string; withPageStore: Map<string, any>;}) => {\n  const MaterialsComponent = get(materials, component_devil_type, noop);\n  const storeProps = useDataSourceWithContext(withPageStore);\n  return <MaterialsComponent {...rest} {...storeProps} />\n})\n\nconst ComponentNoContext = memo(({ component_devil_type, ...rest } : {component_devil_type: string;}) => {\n  const MaterialsComponent = get(materials, component_devil_type, noop);\n  return <MaterialsComponent {...rest} />\n})\n\nconst ComponentItem = ({ type, props, ...rest } : {type: string; props: Object;}) => {\n  const {propsType, withPageStore} = useDataSource(type, props, rest);\n  return (\n    <Fragment>\n      {\n        withPageStore.size > 0 ? <ComponentWithContext {...propsType} /> : <ComponentNoContext {...propsType} />\n      }\n    </Fragment>\n  )\n}\n\nconst DynamicComponent = ({node, topPage, ...rest}: { node: Array<any>; [v: string]: unknown }) => {\n  return (\n    <>\n      {\n        node.map(({id, props = {}, type}) => {\n          return (\n            <ComponentItem\n              key={id}\n              type={type}\n              props={props}\n              {...rest}/>\n          )\n        })\n      }\n    </>\n  )\n}\n\nexport default DynamicComponent;\n","import {ReactNode, useMemo} from 'react';\nimport {navigatorBackImpl, navigatorHandler} from '@brushes/utils';\nimport {IconMobile} from '@brushes/simulate-component';\nimport {View} from '@tarojs/components';\nimport Taro, {useRouter} from '@tarojs/taro';\nimport {isTopPage} from \"@/utils\";\nimport './header.scss';\n\nconst env = Taro.getEnv()\nconst HeaderJsx = ({slot, navigationBarTitle}: { slot?: ReactNode; navigationBarTitle: string }) => {\n  const {path} = useRouter();\n\n  const isHiddenHeader = useMemo(() => {\n    if (env === 'WEAPP') return true;\n    return /^\\/pages/.test(path)\n  }, [path])\n\n  const navigator = () => {\n    const flag = isTopPage();\n    if(flag) {\n      navigatorHandler('index')\n      return\n    }\n    navigatorBackImpl(-1)\n  }\n\n  return (\n    <>\n      {isHiddenHeader ? null :\n        <View className='header'>\n          <IconMobile style={{fontSize: 20}} value='xiangzuo' onClick={navigator} />\n          <View className='title'>{navigationBarTitle}</View>\n          <View>{slot}</View>\n        </View>\n      }\n    </>\n  )\n}\n\nexport default HeaderJsx;\n","import {TaroContextProvider, usePageConfig} from '@brushes/taro-hooks';\nimport HeaderJsx from '@/components/header';\nimport DynamicComponent from './dynamicComponent';\n\nconst CommonJsx = ({route, navigationBarTitle, ...rest}: { route : string; navigationBarTitle: string; [v:string]: any}) => {\n  const {node, initialValue} = usePageConfig(route);\n  return (\n    <TaroContextProvider initialValue={initialValue}>\n      <HeaderJsx navigationBarTitle={navigationBarTitle}/>\n      <DynamicComponent node={node} {...rest} />\n    </TaroContextProvider>\n  )\n}\n\nexport default CommonJsx;\n","import TabBar from '@/components/custom-common';\nimport { useMemo } from 'react';\nimport Taro from '@tarojs/taro';\nimport './index.scss';\nconst TabBarWeb = ({base} : { base: boolean }) => {\n\n  const isShow = useMemo(() => {\n    const isWeb = Taro.getEnv() === 'WEB'\n    return isWeb && base\n  }, [base]);\n  if(!isShow) return;\n\n  return <TabBar />\n}\n\nexport default TabBarWeb;\n","export const appendPath = [\n  \"package/one/index\",\n  \"package/two/index\",\n  \"package/three/index\",\n  \"package/four/index\",\n  \"package/five/index\",\n  \"package/six/index\",\n  \"package/seven/index\",\n  \"package/eight/index\",\n  \"package/nine/index\",\n  \"package/ten/index\",\n  \"package/eleven/index\",\n  \"package/twelve/index\",\n  \"package/thirteen/index\",\n  \"package/fourteen/index\",\n  \"package/fifteen/index\",\n  \"package/sixteen/index\",\n  \"package/seventeen/index\",\n  \"package/eighteen/index\",\n  \"package/nineteen/index\",\n  \"package/twenty/index\",\n  \"package/twenty-one/index\",\n  \"package/twenty-two/index\",\n  \"package/twenty-three/index\",\n  \"package/twenty-four/index\",\n  \"package/twenty-five/index\",\n  \"package/twenty-six/index\",\n  \"package/twenty-seven/index\",\n  \"package/twenty-eight/index\",\n  \"package/twenty-nine/index\",\n  \"package/thirty/index\",\n  \"package/thirty-one/index\",\n  \"package/thirty-two/index\",\n  \"package/thirty-three/index\",\n  \"package/thirty-four/index\",\n  \"package/thirty-five/index\",\n  \"package/thirty-six/index\",\n  \"package/thirty-seven/index\",\n  \"package/thirty-eight/index\",\n  \"package/thirty-nine/index\"\n]\n","export const tabBarList = [\n  {\n    pagePath: 'pages/index/index',\n    text: '首页'\n  },\n  {\n    pagePath: 'pages/classify/index',\n    text: '分类'\n  }, {\n    pagePath: 'pages/shopping/index',\n    text: '购物车'\n  }, {\n    pagePath: 'pages/my/index',\n    text: '我的'\n  }, {\n    pagePath: 'pages/dynamicTab/index',\n    text: '自定义页面'\n  }]\n\n\n","import Taro from '@tarojs/taro';\nimport { warrantyLogin } from 'qj-b2c-api';\nimport {get} from 'lodash-es';\n\nasync function checkSession(){\n  return new Promise((resolve, reject) => {\n    Taro.checkSession({\n      success() {\n        return resolve(true)\n      },\n      fail() {\n        return resolve(false)\n      }\n    })\n  })\n}\n\nasync function bindSeller() {\n  const token = Taro.getStorageSync('saas-token')\n  const referrer = Taro.getStorageSync('referrer')\n  if (!token) {\n    return\n  }\n  if (!referrer) {\n    return\n  }\n  // const res = await WXAPI.bindSeller({\n  //   token,\n  //   uid: referrer\n  // })\n}\n\n// 检测登录状态，返回 true / false\nasync function checkHasLogined() {\n  const token = Taro.getStorageSync('saas-token')\n  if (!token) {\n    return false\n  }\n  const loggined = await checkSession()\n  if (!loggined) {\n    Taro.removeStorageSync('saas-token')\n    return false\n  }\n  // const checkTokenRes = await WXAPI.checkToken(token)\n  // if (checkTokenRes.code != 0) {\n  //   wx.removeStorageSync('token')\n  //   return false\n  // }\n  return true\n}\n\nasync function wxaCode(){\n  return new Promise((resolve, reject) => {\n    Taro.login({\n      success(res) {\n        return resolve(res.code)\n      },\n      fail() {\n        Taro.showToast({\n          title: '获取code失败',\n          icon: 'none'\n        })\n        return resolve('获取code失败')\n      }\n    })\n  })\n}\n\nexport function login(bindImpl){\n  return new Promise((resolve, reject) => {\n    Taro.login({\n      success: function (result) {\n        warrantyLogin({\n          js_code: result.code\n        }).then(function (res) {\n          // 异常情况\n          if (!res.dataObj) {\n            // 登录错误\n            Taro.showToast({\n              title: '无法登录',\n              icon: \"error\",\n              duration: 1500\n            })\n            reject()\n            return;\n          }\n\n          const isReister = get(res, 'dataObj.register', \"\");\n          const userOpenid = get(res, 'dataObj.userOpenid', \"\");\n          Taro.setStorageSync('userOpenid', userOpenid)\n\n          if (isReister === \"true\") {\n            // 去绑定\n            bindImpl()\n            return;\n          }\n\n          const token = get(res, 'dataObj.userInfo', \"{}\");\n          Taro.setStorageSync('saas-token', token)\n          resolve('')\n        })\n      }\n    })\n  })\n\n}\n\nasync function authorize() {\n  // const code = await wxaCode()\n  // const resLogin = await WXAPI.login_wx(code)\n  // if (resLogin.code == 0) {\n  //   wx.setStorageSync('token', resLogin.data.token)\n  //   wx.setStorageSync('uid', resLogin.data.uid)\n  //   return resLogin\n  // }\n  return new Promise((resolve, reject) => {\n    Taro.login({\n      success: function (res) {\n        const code = res.code\n        let referrer = '' // 推荐人\n        let referrer_storge = wx.getStorageSync('referrer');\n        if (referrer_storge) {\n          referrer = referrer_storge;\n        }\n        // 下面开始调用注册接口\n        const extConfigSync = wx.getExtConfigSync()\n        if (extConfigSync.subDomain) {\n          WXAPI.wxappServiceAuthorize({\n            code: code,\n            referrer: referrer\n          }).then(function (res) {\n            if (res.code == 0) {\n              wx.setStorageSync('token', res.data.token)\n              wx.setStorageSync('uid', res.data.uid)\n              resolve(res)\n            } else {\n              wx.showToast({\n                title: res.msg,\n                icon: 'none'\n              })\n              reject(res.msg)\n            }\n          })\n        } else {\n          WXAPI.authorize({\n            code: code,\n            referrer: referrer\n          }).then(function (res) {\n            if (res.code == 0) {\n              wx.setStorageSync('token', res.data.token)\n              wx.setStorageSync('uid', res.data.uid)\n              resolve(res)\n            } else {\n              wx.showToast({\n                title: res.msg,\n                icon: 'none'\n              })\n              reject(res.msg)\n            }\n          })\n        }\n      },\n      fail: err => {\n        reject(err)\n      }\n    })\n  })\n}\n\nfunction loginOut(){\n  Taro.removeStorageSync('token')\n  Taro.removeStorageSync('uid')\n}\n\nasync function checkAndAuthorize (scope) {\n  return new Promise((resolve, reject) => {\n    Taro.getSetting({\n      success(res) {\n        if (!res.authSetting[scope]) {\n          Taro.authorize({\n            scope: scope,\n            success() {\n              resolve() // 无返回参数\n            },\n            fail(e){\n              console.error(e)\n              // if (e.errMsg.indexof('auth deny') != -1) {\n              //   wx.showToast({\n              //     title: e.errMsg,\n              //     icon: 'none'\n              //   })\n              // }\n              Taro.showModal({\n                title: '无权操作',\n                content: '需要获得您的授权',\n                showCancel: false,\n                confirmText: '立即授权',\n                confirmColor: '#e64340',\n                success(res) {\n                  Taro.openSetting();\n                },\n                fail(e){\n                  console.error(e)\n                  reject(e)\n                },\n              })\n            }\n          })\n        } else {\n          resolve() // 无返回参数\n        }\n      },\n      fail(e){\n        console.error(e)\n        reject(e)\n      }\n    })\n  })\n}\n\nconst mobileRex = /^1[3456789]\\d{9}$/\n\nexport default {\n  checkHasLogined,\n  // wxaCode: wxaCode,\n  // login: login,\n  // loginOut: loginOut,\n  checkAndAuthorize,\n  // authorize: authorize,\n  // bindSeller: bindSeller\n  mobileRex\n}\n","export { default as auth } from './auth';\nexport * from './validator';\nexport * from './safeArea';\nexport * from './router';\n","import Taro from '@tarojs/taro';\n\nexport const isTopPage = () => {\n  const pageLength = Taro.getCurrentPages().length;\n  return pageLength === 1;\n}\n","import Taro from \"@tarojs/taro\";\n\nexport const safeArea = () => {\n  try {\n    const systemInfo = Taro.getSystemInfoSync();\n    const screenHeight = systemInfo.screenHeight;\n    const safeHeight = systemInfo.safeArea?.bottom || systemInfo.screenHeight;\n    const screenWidth = systemInfo.screenWidth;\n    Taro.setStorageSync('safeArea', screenHeight - safeHeight);\n    Taro.setStorageSync('tabBarHeight', Math.floor(50 * screenWidth / 375))\n  } catch (e) {\n    console.log(e)\n  }\n}\n","\n\nexport const checkMobile = (_: any, value: string) => {\n  if (/^1[3456789]\\d{9}$/.test(value)) {\n    return Promise.resolve()\n  }\n\n  return Promise.reject({ required: true, message: \"请输入正确手机号\" })\n}\n\nexport const mobileRex = /^1[3456789]\\d{9}$/;\n","/* (ignored) */"],"names":[],"sourceRoot":""}